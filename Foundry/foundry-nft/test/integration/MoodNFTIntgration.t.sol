// SPDX-License-Identifier: MIT
pragma solidity ^0.8.19;

import {Test, console} from "forge-std/Test.sol";
import {DeployMoodNFT} from "script/DeployMoodNFT.s.sol";
import {MoodNFT} from "../../src/MoodNFT.sol";

contract MoodNFTImtegration is Test {
    MoodNFT public moodNFT;
    DeployMoodNFT public deployer;
    address public USER = makeAddr("user");
    string public constant HAPPY_SVG_URI =
        "data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAwIDIwMCIgd2lkdGg9IjQwMCIgIGhlaWdodD0iNDAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KICA8Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIGZpbGw9InllbGxvdyIgcj0iNzgiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS13aWR0aD0iMyIvPg0KICA8ZyBjbGFzcz0iZXllcyI+DQogICAgPGNpcmNsZSBjeD0iNzAiIGN5PSI4MiIgcj0iMTIiLz4NCiAgICA8Y2lyY2xlIGN4PSIxMjciIGN5PSI4MiIgcj0iMTIiLz4NCiAgPC9nPg0KICA8cGF0aCBkPSJtMTM2LjgxIDExNi41M2MuNjkgMjYuMTctNjQuMTEgNDItODEuNTItLjczIiBzdHlsZT0iZmlsbDpub25lOyBzdHJva2U6IGJsYWNrOyBzdHJva2Utd2lkdGg6IDM7Ii8+DQo8L3N2Zz4=";

    string public constant SAD_SVG_IMAGE_URI =
        "data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAwIDIwMCIgd2lkdGg9IjQwMCIgIGhlaWdodD0iNDAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KICA8Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIGZpbGw9InllbGxvdyIgcj0iNzgiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS13aWR0aD0iMyIvPg0KICA8ZyBjbGFzcz0iZXllcyI+DQogICAgPGNpcmNsZSBjeD0iNzAiIGN5PSI4MiIgcj0iMTIiLz4NCiAgICA8Y2lyY2xlIGN4PSIxMjciIGN5PSI4MiIgcj0iMTIiLz4NCiAgPC9nPg0KICA8cGF0aCBkPSJtMTM2LjgxIDEyNi41M2MuNjkgMC4wLTAuMCAwLTgxLjAtLjAiIHN0eWxlPSJmaWxsOm5vbmU7IHN0cm9rZTogYmxhY2s7IHN0cm9rZS13aWR0aDogMzsiLz4NCjwvc3ZnPg==";

    string public constant SAD_SVG_URI =
        "data:application/json;base64,eyJuYW1lIjogTW9vZCBORlQsICJkZXNjcmlwdGlvbiI6ICJBIE1vb2QgTkZUIHRoYXQgcmVmbGVjdHMgb3duZXJzIG1vb2RzIiwgImF0dHJpYnV0ZXMiOiBbeyJ0cmFpdF90eXBlIjogIm1vb2RpbmVzcyIsICJ2YWx1ZSI6IDEwMH1dLCAiaW1hZ2UiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCMmFXVjNRbTk0UFNJd0lEQWdNakF3SURJd01DSWdkMmxrZEdnOUlqUXdNQ0lnSUdobGFXZG9kRDBpTkRBd0lpQjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaVBnMEtJQ0E4WTJseVkyeGxJR040UFNJeE1EQWlJR041UFNJeE1EQWlJR1pwYkd3OUlubGxiR3h2ZHlJZ2NqMGlOemdpSUhOMGNtOXJaVDBpWW14aFkyc2lJSE4wY205clpTMTNhV1IwYUQwaU15SXZQZzBLSUNBOFp5QmpiR0Z6Y3owaVpYbGxjeUkrRFFvZ0lDQWdQR05wY21Oc1pTQmplRDBpTnpBaUlHTjVQU0k0TWlJZ2NqMGlNVElpTHo0TkNpQWdJQ0E4WTJseVkyeGxJR040UFNJeE1qY2lJR041UFNJNE1pSWdjajBpTVRJaUx6NE5DaUFnUEM5blBnMEtJQ0E4Y0dGMGFDQmtQU0p0TVRNMkxqZ3hJREV4Tmk0MU0yTXVOamtnTWpZdU1UY3ROalF1TVRFZ05ESXRPREV1TlRJdExqY3pJaUJ6ZEhsc1pUMGlabWxzYkRwdWIyNWxPeUJ6ZEhKdmEyVTZJR0pzWVdOck95QnpkSEp2YTJVdGQybGtkR2c2SURNN0lpOCtEUW84TDNOMlp6NE5DZzBLUENFdExTQmtZWFJoT21sdFlXZGxMM04yWnl0NGJXdzdZbUZ6WlRZMExGQklUakphZVVJeVlWZFdNMUZ0T1RSUVUwbDNTVVJCWjAxcVFYZEpSRWwzVFVOSloyUXliR3RrUjJjNVNXcFJkMDFEU1dkSlIyaHNZVmRrYjJSRU1HbE9SRUYzU1dsQ05HSlhlSFVOQ21ONk1HbGhTRkl3WTBSdmRrd3paRE5rZVRVelRYazFkbU50WTNaTmFrRjNUVU01ZW1SdFkybFFaekJMU1VOQk9Ga3liSGxaTW5oc1NVZE9ORkJUU1hoTlJFRnBTVWRPTlZCVFNYZ05DazFFUVdsSlIxcHdZa2QzT1VsdWJHeGlSM2gyWkhsSloyTnFNR2xPZW1kcFNVaE9NR050T1hKYVZEQnBXVzE0YUZreWMybEpTRTR3WTIwNWNscFRNVE5oVjFJd1lVUXdhVTE1U1hZTkNsQm5NRXRKUTBFNFdubENhbUpIUm5wamVqQnBXbGhzYkdONVNTdEVVVzluU1VOQloxQkhUbkJqYlU1eldsTkNhbVZFTUdsT2VrRnBTVWRPTlZCVFNUUk5hVWxuWTJvd2FVMVVTV2tOQ2t4Nk5FNURhVUZuU1VOQk9Ga3liSGxaTW5oc1NVZE9ORkJUU1hoTmFtTnBTVWRPTlZCVFNUUk5hVWxuWTJvd2FVMVVTV2xNZWpST1EybEJaMUJET1c1UVp6QkxTVU5CT0dOSFJqQU5DbUZEUW10UVUwcDBUVlJOTWt4cVozaEpSRVY0VG1rME1VMHlUWFZPYW10blRXcFpkVTFVWTNST2FsRjFUVlJGWjA1RVNYUlBSRVYxVGxSSmRFeHFZM3BKYVVKNlpFaHNjMXBVTUdrTkNscHRiSE5pUkhCMVlqSTFiRTk1UW5wa1NFcDJZVEpWTmtsSFNuTlpWMDV5VDNsQ2VtUklTblpoTWxWMFpESnNhMlJIWnpaSlJFMDNTV2s0SzBSUmJ6aE1NMDR5V25vMFBTQXRMVDQ9In0=";

    function setUp() public {
        deployer = new DeployMoodNFT();
        moodNFT = deployer.run();
    }

    function testViewTokenURIIntegration() public {
        vm.prank(USER);
        moodNFT.mintNft();
        console.log(moodNFT.tokenURI(0));
    }

    function testFlipTokenToSad() public {
        vm.prank(USER);
        moodNFT.mintNft();

        vm.prank(USER);
        moodNFT.flipMood(0);

        assertEq(
            keccak256(abi.encodePacked(moodNFT.tokenURI(0))),
            keccak256(abi.encodePacked(SAD_SVG_URI))
        );
    }
}
